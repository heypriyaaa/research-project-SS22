---
title: "Data Analysis of T-Cell Dysfunction in the Glioblastoma Microenvironment is Mediated by Myeloid Cells Releasing Interleukin-10"
author: "Banupriya Jayarama Reddy"
output: html_notebook
editor_options: 
  chunk_output_type: inline
---

Load required library

```{r}
#===============================================================================
# Library
#===============================================================================
library(tibble)
```


Import the data into objects but somehow the factor was not kept from the `data-preprocessor.R` script so have to tidy up the data again for further data analysis.


```{r}
#===============================================================================
# Import
#===============================================================================
# load the data into individual objects
tumor_data <- read.csv(file = "tumor_data.csv")
t_cell_data <- read.csv(file = "t_cell_data.csv")
# load the first six line of data just to double check
head(tumor_data)
head(t_cell_data)

#===============================================================================
# Tidy
#===============================================================================
# clean up the data by making them into factor, somehow factor in data-preprocessor.R did not work
# tumor data
tumor_data$Cell_ID_Myeloid <- as.factor(tumor_data$Cell_ID_Myeloid)
tumor_data$Cell_ID_Tumor <- as.factor(tumor_data$Cell_ID_Tumor)
tumor_data$Cell_type <- as.factor(tumor_data$Cell_type)
# use tibble to tidy up the data
tumor_data <- as_tibble(tumor_data)

# t cell data
t_cell_data$Cell_ID_Myeloid <- as.factor(t_cell_data$Cell_ID_Myeloid)
t_cell_data$Cell_ID_T_Cell <- as.factor(t_cell_data$Cell_ID_T_Cell)
t_cell_data$Cell_type <- as.factor(t_cell_data$Cell_type)
# use tibble to tidy up the data
t_cell_data <- as_tibble(t_cell_data)

# generate summary and correlation to give an overview
summary(t_cell_data)
summary(tumor_data)
```

Reproducing the density graph like in the Figure 6c for the purpose of validating the data.

```{r}
#===============================================================================
# Validate
#===============================================================================
# tumor
# compute density
density_tumor_distance_hpositive <- density(tumor_data$Distance[tumor_data$Cell_type == "H+"])
density_tumor_distance_hnegative <- density(tumor_data$Distance[tumor_data$Cell_type == "H-"])
# plot density graph
#png(file = "./density_plot_distance_to_tumor.png") # uncomment this and dev.off to print image in png format
plot(density_tumor_distance_hpositive, lwd = 2, col = "blue", main = "Distance to Tumor cells")
polygon(density_tumor_distance_hpositive, col = rgb(0, 0, 1, alpha = 0.5))
lines(density_tumor_distance_hnegative, lwd = 2, col = "red")
polygon(density_tumor_distance_hnegative, col = rgb(1, 0, 0, alpha = 0.5))
#dev.off()

# t cell
# compute density
density_t_cell_distance_hpositive <- density(t_cell_data$Distance[t_cell_data$Cell_type == "H+"])
density_t_cell_distance_hnegative <- density(t_cell_data$Distance[t_cell_data$Cell_type == "H-"])
# plot density graph
#png(file = "./density_plot_distance_to_t_cells.png")
plot(density_t_cell_distance_hpositive, lwd = 2, col = "blue", main = "Distance to T cells")
polygon(density_t_cell_distance_hpositive, col = rgb(0, 0, 1, alpha = 0.5))
lines(density_t_cell_distance_hnegative, lwd = 2, col = "red")
polygon(density_t_cell_distance_hnegative, col = rgb(1, 0, 0, alpha = 0.5))
#dev.off()
```
The density graph produced are similar shaped to the Figure 6c in the paper but somehow the graphs in the paper are mixed up (the paper used Distance to T Cells as Distance to Tumor cells instead and vice versa)

```{r}
#===============================================================================
# Understand (Transform, Model, Visualize)
#===============================================================================
```

